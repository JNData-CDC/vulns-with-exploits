from datetime import date, timedelta

from NVDVulnDownloader import NVDVulnDownloader
from VulnsWithExploits import VulnsWithExploits

from sys import exc_info

def main():
    # for now the time range is hardcoded to be 365 days
    today = date.today()
    start_date = today - timedelta(days=365)
    
    # run the downloader
    nd = NVDVulnDownloader(start_date, today)    
    nd.run()

    # run the code that gets a list of vulns in a given time range
    ve = VulnsWithExploits()
    vuln_set = ve.get_vuln_ids(start_date, today)
    #DEBUG
    with open("cves.txt", "w") as fp:
        fp.write("\n".join(vuln_set))
    #DEBUG END
    
if __name__ == "__main__":
    main()